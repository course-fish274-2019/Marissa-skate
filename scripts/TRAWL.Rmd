---
title: "Trawl Data Analysis"
author: "Marissa Leatherman"
date: "12/5/2019"
output: html_document
---

```{r library}
library(oceanmap)
library(rgeos)
library(ggplot2)
library(rnaturalearth)
library(rnaturalearthdata)
library(sf)
library(tidyverse)
library(ggplot2)
library(ggmap)
library(maps)
library(mapdata)


```



```{r setup}

trawlall <- read.csv("../data/ebs2017_2018.csv", header=TRUE, sep=',')
ai <- read.csv("../data/ai2014_2018.csv", header=TRUE, sep=',')
bss <- read.csv("../data/bsslope2002_2016.csv", header=TRUE, sep=',')
goa <- read.csv("../data/goa2015_2017.csv", header=TRUE, sep=',')
nbs <- read.csv("../data/nbs1982_2018.csv", header=TRUE, sep=',')

trawlall <- 
  rbind(ai, trawlall) %>% 
  rbind(bss, trawlall) %>% 
  rbind(goa, trawlall) %>% 
  rbind(nbs, trawlall)

```

```{r filter}
trawl <- 
  trawlall %>% 
  separate('GENUS_SPECIES', c('GENUS','SPECIES'),'_', extra='drop') %>%
  separate('DATETIME', c('DATE','TIME'),'_', extra='drop') %>%
  select('LATITUDE','LONGITUDE','DATE','TIME','GENUS','SPECIES','BOT_DEPTH','BOT_TEMP', 'SURF_TEMP')

Pagurus <- 
  trawl %>% 
  filter(GENUS=='Pagurus')

Gadus <-
  trawl %>% 
  filter(GENUS=='Gadus')

trawl <- rbind(Gadus, Pagurus)
```

```{r map}

sites <- st_as_sf(trawl, coords = c("LONGITUDE", "LATITUDE"), crs = 4326, agr = "constant")
world <- map_data("world")
plt1 <- 
  ggplot() +
  geom_polygon(data = world, aes(x = long, y = lat, group=group)) +
  coord_fixed(xlim = c(-180.0, -130.0), ylim = c(50., 70.), ratio = 1.3) +
  geom_point(data=trawl, aes(x= LONGITUDE, y = LATITUDE, fill=GENUS, color=GENUS), alpha = 0.3)
  
plt1

```


```{r graph}
ggplot() +
  geom_point(data=trawl, mapping = aes(x = BOT_TEMP,y=SURF_TEMP, color=GENUS), alpha = 0.3)+
  scale_y_log10()+
  scale_x_continuous()+
  labs(x='Temperature at Trawl Depth (degrees C)',y='Surface Temperature (degrees C))')+
  labs(title='Distribution of Bottom Dwelling Arctic Species 
       in the Bering Strait as Surface and At-depth Temperature Changes')+
  facet_wrap(~GENUS)


```

